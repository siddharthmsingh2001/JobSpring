<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org/" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <link th:rel="stylesheet" th:href="@{/webjars/bootstrap/css/bootstrap.min.css} "/>
    <link rel="stylesheet" type="text/css" media="all" th:href="@{/css/font-awesome.min.css}"/>
    <link rel="stylesheet" type="text/css" media="all" th:href="@{/css/styles.css}"/>
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"/>
    <meta charset="ISO-8859-1"/>
    <title>Profile Setup</title>
</head>

<body>
<div class="row" style="margin-right:0; ">
    <div class="col-5 coffee_mug_background">
        <div class="logo_left mt-3 pt-4 ms-5 pl-5">
            <h2 class="logo" style="color: white">
                jobspring <span class="logo_com">.com</span>
            </h2>
        </div>
    </div>
    <div class="col-7">
        <div class="myForm">
            <form th:action="@{/seeker-dashboard/profile}" th:object="${seekerProfileDto}" method="post" enctype="multipart/form-data">
                <div class="row" style="margin-right:0; margin-left:0;">
                    <div class="col-md-12">
                        <div class="d-flex justify-content-center pt-3">
                            <h1 class="heading_font font-weight-bold">Candidate</h1>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div>
                            <h2 class="heading_font d-flex justify-content-center">
                                Set up your Profile
                            </h2>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <label class="heading_font font_sub_heading_color">Name</label>
                        <div class="row">
                            <div class="col-md-6 pr-1">
                                <input id="accountId" th:field="*{accountId}" name="accountId" type="text" hidden/>
                                <input placeholder="First Name" id="firstName" th:field="*{firstName}" name="firstName" type="text" class="form-control"/>
                            </div>
                            <div class="col-md-6 pl-1">
                                <input placeholder="Last Name" id="lastName" name="lastName" th:field="*{lastName}" type="text" class="form-control"/>
                            </div>
                        </div>
                        <div class="row ">
                            <div class="col-md-4 pr-1">
                                <input placeholder="City" name="city" th:field="*{city}" type="text" class="form-control"/>
                            </div>
                            <div class="col-md-4 px-1">
                                <input placeholder="State" name="state" type="text" th:field="*{state}" class="form-control"/>
                            </div>
                            <div class="col-md-4 pl-1">
                                <input placeholder="Country" name="country" th:field="*{country}" type="text" class="form-control"/>
                            </div>
                        </div>
                        <label class="mt-3 heading_font font_sub_heading_color">Work Classification</label>
                        <div class="row">
                            <div class="form-group col-md-6 pr-1">
                                <select required class="form-control" name="workAuthorization" th:field="*{workAuthorization}">
                                    <option value="" selected>Work Authorization</option>
                                    <option value="E-Visa">E-Visa</option>
                                    <option value="E-Visa">B-Visa</option>
                                    <option value="PRS">PRS</option>
                                    <option value="OCI">OCI</option>
                                </select>
                            </div>
                            <div class="form-group col-md-6 pl-1">
                                <select required class="form-control" name="employmentType" th:field="*{employmentType}">
                                    <option value="" selected>Seeking Employment</option>
                                    <option value="Full-Time">Full-time</option>
                                    <option value="Part-Time">Part-time</option>
                                    <option value="Freelance">Freelance</option>
                                </select>
                            </div>
                        </div>
                        <label class=" heading_font font_sub_heading_color">Skills</label>
                        <div class="parent">
                            <!-- Existing skills rendered here -->
                            <div th:each="skill, iterStat : *{skills}" class="skill-repeat mb-3">
                                <div class="row align-items-center">
                                    <div class="col-md-3">
                                        <input type="hidden" th:field="*{skills[__${iterStat.index}__].id}"/>
                                        <input type="text" placeholder="Skill Name" class="form-control"
                                               th:field="*{skills[__${iterStat.index}__].name}"/>
                                    </div>
                                    <div class="col-md-3">
                                        <input type="text" placeholder="Years of Experience" class="form-control"
                                               th:field="*{skills[__${iterStat.index}__].yearExperience}"/>
                                    </div>
                                    <div class="col-md-3">
                                        <select required class="form-control"
                                                th:field="*{skills[__${iterStat.index}__].experienceLevel}">
                                            <option value="" disabled selected>Experience Level</option>
                                            <option value="Beginner">Beginner</option>
                                            <option value="Intermediate">Intermediate</option>
                                            <option value="Advance">Advance</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <button type="button" class="btn btn-danger remove-skill">Remove</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row gutters">
                            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                                <div class="text-left mt-2">
                                    <button type="button" class="btn btn-outline-secondary" id="addSkill">
                                        Add Skill
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md-5 me-5">
                                <label class="heading_font font_sub_heading_color">Profile Photo</label>
                                <input type="file" name="image" class="form-control" accept="image/jpeg"/>
                                <input type="text" name="profilePhoto" th:field="*{profilePhoto}" class="form-control" hidden/>

                            </div>
                            <div class="col-md-5 me-5">
                                <label class="heading_font font_sub_heading_color">Resume</label>
                                <input type="file" name="pdf" class="form-control" required="true" accept="application/pdf"/>
                                <input type="text" name="resume" th:field="*{resume}" class="form-control" hidden/>
                                <a th:href="@{|/seeker-dashboard/profile/downloadResume?fileName=${seekerProfileDto.resume}&&id=${seekerProfileDto.accountId}|}">Download Resume</a>
                            </div>
                        </div>
                        <div class="row mt-4" >
                            <div class="col d-flex justify-content-center gap-3">
                                <button type="submit" name="submit" class="btn btn-primary base_button px-4 py-2">Save</button>
                                <a th:href="@{/seeker-dashboard}" class="btn btn-secondary base_button px-4 py-2">Cancel</a>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
</body>
<script
        type="text/javascript"
        th:src="@{/webjars/jquery/jquery.min.js}"
></script>
<script
        type="text/javascript"
        th:src="@{/webjars/popper.js/umd/popper.min.js}"
></script>
<script
        type="text/javascript"
        th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"
></script>
<script type="text/javascript" th:src="@{/js/main.js}"></script>
<script sec:authorize="hasAuthority('RECRUITER')">
    console.log("Disable inputs");
  $("input").prop( "disabled", true );
   $("select").prop( "disabled", true );
       $("button").prop( "disabled", true );
</script>
<script>
    var counter = [[${#lists.size(seekerProfileDto.skills)}]] - 1;

    $(document).on("click", "#addSkill", function (e) {
        e.preventDefault();
        counter++;
        var newRow = $("<div class='skill-repeat mb-3'>" +
            "  <div class='row align-items-center'>" +
            "    <div class='col-md-3'>" +
            "      <input type='hidden' name='skills[" + counter + "].id' />" +
            "      <input type='text' placeholder='Skill Name' class='form-control' name='skills[" + counter + "].name' />" +
            "    </div>" +
            "    <div class='col-md-3'>" +
            "      <input type='text' placeholder='Years of Experience' class='form-control' name='skills[" + counter + "].yearExperience' />" +
            "    </div>" +
            "    <div class='col-md-3'>" +
            "      <select required class='form-control' name='skills[" + counter + "].experienceLevel'>" +
            "        <option disabled selected>Experience Level</option>" +
            "        <option value='Beginner'>Beginner</option>" +
            "        <option value='Intermediate'>Intermediate</option>" +
            "        <option value='Advance'>Advance</option>" +
            "      </select>" +
            "    </div>" +
            "    <div class='col-md-3'>" +
            "      <button type='button' class='btn btn-danger remove-skill'>Remove</button>" +
            "    </div>" +
            "  </div>" +
            "</div>");
        $(".parent").append(newRow);
    });
    $(document).on("click", ".remove-skill", function () {
        $(this).closest(".skill-repeat").remove();
    });
</script>
</html>